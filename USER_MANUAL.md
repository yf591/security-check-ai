# 📘 セキュリティチェックAI 取扱説明書

**バージョン**: 1.0  
**最終更新**: 2025年12月

---

## 目次

1. [はじめに](#はじめに)
2. [システム要件](#システム要件)
3. [インストール方法](#インストール方法)
4. [起動方法](#起動方法)
5. [基本的な使い方](#基本的な使い方)
6. [機能詳細](#機能詳細)
7. [よくある質問](#よくある質問)
8. [トラブルシューティング](#トラブルシューティング)
9. [お問い合わせ](#お問い合わせ)

---

## はじめに

### セキュリティチェックAIとは

セキュリティチェックAIは、過去のセキュリティチェックシートやQ&A資料を学習し、新しいセキュリティ質問に対して適切な回答を自動的に提案する営業支援ツールです。

### できること

- ✅ 過去のセキュリティチェック資料（PDF、Word、Excel等）からQ&Aデータベースを自動構築
- ✅ 質問を入力すると、類似する過去の質問と回答を瞬時に検索
- ✅ 複数の質問を一括処理して、まとめて回答を取得
- ✅ 検索結果をCSVファイルでダウンロード
- ✅ 検索履歴の管理と共有

### こんな方におすすめ

- セキュリティチェックシートの回答作成に時間がかかっている営業担当者
- 過去の回答資料を探すのに苦労している方
- チーム全体でセキュリティ回答の品質を統一したい方

---

## システム要件

### 必須環境

- **OS**: Windows 10/11、macOS 10.15以降、またはLinux
- **Python**: バージョン 3.8 以上
- **メモリ**: 4GB以上（推奨：8GB以上）
- **ストレージ**: 2GB以上の空き容量
- **インターネット接続**: 初回起動時のみ必要

### 推奨環境

- メモリ：8GB以上
- CPU：Intel Core i5相当以上
- ストレージ：SSD推奨

---

## インストール方法

### Windows の場合

#### ステップ1: Pythonのインストール

1. https://www.python.org/downloads/ にアクセス
2. 最新版のPythonをダウンロード
3. インストーラーを実行
4. **重要**: 「Add Python to PATH」にチェックを入れる
5. 「Install Now」をクリック

#### ステップ2: プロジェクトの配置

1. `security-check-ai` フォルダを任意の場所に配置
   - 例: `C:\Users\YourName\Documents\security-check-ai`

#### ステップ3: 仮想環境の作成

1. コマンドプロンプトを開く（`Win + R` → `cmd`）
2. プロジェクトフォルダに移動
   ```cmd
   cd C:\Users\YourName\Documents\security-check-ai
   ```
3. 仮想環境を作成
   ```cmd
   python -m venv .venv
   ```

#### ステップ4: パッケージのインストール

1. 仮想環境をアクティベート
   ```cmd
   .venv\Scripts\activate
   ```
2. 必要なパッケージをインストール
   ```cmd
   pip install -r requirements.txt
   ```
   ※ 初回は5-10分程度かかります

### macOS / Linux の場合

#### ステップ1: Pythonの確認

```bash
python3 --version
```
Python 3.8以上であることを確認

#### ステップ2: プロジェクトの配置

`security-check-ai` フォルダを任意の場所に配置

#### ステップ3: 仮想環境の作成とパッケージインストール

```bash
cd /path/to/security-check-ai
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

---

## 起動方法

### Windows

#### 方法A: 簡単起動（推奨）

1. `start_app.bat` ファイルをダブルクリック
2. 自動的にブラウザが開きます

#### 方法B: コマンドプロンプトから

```cmd
cd C:\path\to\security-check-ai
.venv\Scripts\activate
streamlit run app.py
```

### macOS / Linux

#### 方法A: スクリプトから

```bash
cd /path/to/security-check-ai
./start_app.sh
```

#### 方法B: コマンドから

```bash
cd /path/to/security-check-ai
source .venv/bin/activate
streamlit run app.py
```

### 起動確認

ブラウザが自動的に開き、以下のURLが表示されます：
```
http://localhost:8501
```

ブラウザが開かない場合は、手動でこのURLにアクセスしてください。

---

## 基本的な使い方

### 初回セットアップ（データの準備）

#### サンプルデータで試す

1. アプリを起動
2. 画面左側のサイドバーで「🔄 data/rawから再構築」ボタンをクリック
3. サンプルデータ（15件のQ&A）が自動的に読み込まれます
4. 数分待つと「データベース構築完了」のメッセージが表示されます

#### 独自のデータを追加する

**方法1: ファイルアップロード**

1. サイドバーの「ファイルをアップロード」セクションを開く
2. 「Browse files」をクリック
3. 以下のいずれかのファイルを選択：
   - PDF (.pdf)
   - Word文書 (.docx)
   - Excelファイル (.xlsx, .xls)
   - CSVファイル (.csv)
   - テキストファイル (.txt)
4. 「📥 ファイルを処理してDBに追加」ボタンをクリック
5. 処理が完了するまで待つ

**方法2: フォルダに直接配置**

1. `data/raw/` フォルダに資料ファイルをコピー
2. サイドバーの「🔄 data/rawから再構築」ボタンをクリック
3. 全ファイルが一括で処理されます

### 質問の検索

#### 単一の質問を検索

1. 「🔍 質問検索」タブを開く
2. テキストエリアに質問を入力
   ```
   例: データの暗号化方法について教えてください
   ```
3. 必要に応じて設定を調整：
   - **検索結果数**: 表示する回答の数（1-10）
   - **類似度閾値**: 検索精度の調整（0.5推奨）
4. 「🔍 検索」ボタンをクリック
5. 結果が表示されます

#### 検索結果の見方

各回答には以下の情報が表示されます：

- **類似度スコア**: 質問との類似度（100%に近いほど関連性が高い）
- **質問**: データベース内のマッチした質問
- **回答**: その質問に対する回答
- **出典**: 元になった資料ファイル名

結果は類似度の高い順に表示されます。

### 一括質問処理

#### テキスト入力で一括処理

1. 「📝 一括質問処理」タブを開く
2. 「テキスト入力」を選択
3. テキストエリアに質問を入力（1行に1質問）
   ```
   データの暗号化方法について
   アクセス制御の設定方法
   バックアップの頻度について
   ```
4. 設定を調整：
   - **各質問の検索結果数**: 1-5（通常は1）
   - **類似度閾値**: 0.6推奨（一括処理では少し高めに）
5. 「🚀 一括検索」ボタンをクリック

#### CSVファイルから一括処理

1. 「📝 一括質問処理」タブを開く
2. 「CSVファイル」を選択
3. CSVファイルをアップロード
4. 質問が含まれる列を選択
5. 「🚀 一括検索」ボタンをクリック

#### 結果のダウンロード

1. 処理完了後、結果が表形式で表示されます
2. 「📥 結果をCSVでダウンロード」ボタンをクリック
3. ファイルが `security_check_results_YYYYMMDD_HHMMSS.csv` として保存されます

---

## 機能詳細

### データ管理機能

#### 登録済みQ&A件数の確認

サイドバー上部に常時表示されています。
```
登録済みQ&A件数
123
```

#### データベースの再構築

- **用途**: `data/raw/` フォルダ内の全ファイルを再読込
- **手順**: サイドバーの「🔄 data/rawから再構築」ボタンをクリック
- **注意**: 既存のデータは削除され、新しく読み込まれます

#### データベースのクリア

- **用途**: 全てのQ&Aデータを削除
- **手順**: サイドバーの「🗑️ データベースをクリア」ボタンをクリック
- **注意**: 取り消しできません。慎重に実行してください

### 検索履歴機能

#### 履歴の確認

1. 「📊 履歴」タブを開く
2. 過去の検索履歴が表形式で表示されます

表示内容：
- タイムスタンプ
- 検索クエリ
- マッチした質問
- 回答
- 類似度
- 出典

#### 履歴のエクスポート

1. 「📊 履歴」タブを開く
2. 「�� 履歴をCSVでダウンロード」ボタンをクリック
3. ファイルが `security_check_history_YYYYMMDD_HHMMSS.csv` として保存されます

#### 履歴のクリア

「🗑️ 履歴をクリア」ボタンをクリックすると、表示中の履歴が削除されます。

### 検索精度の調整

#### 検索結果数

- **設定値**: 1-10
- **推奨**: 単一質問は3-5、一括処理は1-2
- **効果**: 多いほど選択肢が増えるが、確認に時間がかかる

#### 類似度閾値

- **設定値**: 0.0-1.0
- **推奨**: 0.5-0.6
- **効果**: 
  - 低い（0.3-0.5）: 幅広く検索、精度は下がる
  - 中程度（0.5-0.7）: バランスが良い（推奨）
  - 高い（0.7-1.0）: 精度重視、該当なしが増える

---

## よくある質問

### Q1: どのようなファイルに対応していますか？

**A**: 以下のファイル形式に対応しています：
- PDF (.pdf)
- Microsoft Word (.docx)
- Microsoft Excel (.xlsx, .xls)
- CSV (.csv)
- テキストファイル (.txt)

### Q2: Q&Aのフォーマットはどうすればいいですか？

**A**: 以下のいずれかの形式で記述されていれば自動認識します：

```
Q: 質問文
A: 回答文

質問: 質問文
回答: 回答文

【質問】質問文
【回答】回答文
```

ExcelやCSVの場合、「質問」「Q」「回答」「A」といった列名があれば自動的に認識します。

### Q3: インターネット接続は常に必要ですか？

**A**: 初回起動時のみ必要です（埋め込みモデルのダウンロード）。以降はオフラインで使用できます。

### Q4: データはどこに保存されますか？

**A**: 全てのデータはローカルPC内の以下のフォルダに保存されます：
- 元データ: `data/raw/`
- ベクトルデータベース: `vectordb/`

外部サーバーには一切送信されません。

### Q5: 複数人で同時に使えますか？

**A**: 1つのアプリケーションインスタンスは1人が使用します。複数人で使う場合は：
- 各自のPCにインストール
- または、共有サーバーで起動して異なるポートで複数立ち上げ

### Q6: データを追加したら自動的に学習されますか？

**A**: はい。ファイルをアップロードまたは「再構築」を実行すると、自動的にデータベースに追加されます。

### Q7: 精度を上げるにはどうすればいいですか？

**A**: 以下の方法で精度が向上します：
1. より多くのQ&Aデータを登録（100件以上推奨）
2. 質問と回答が明確に区別されたデータを使用
3. 類似度閾値を適切に調整（0.5-0.6推奨）

### Q8: 検索結果が表示されません

**A**: 以下を確認してください：
1. データベースにデータが登録されているか（サイドバーの件数を確認）
2. 類似度閾値が高すぎないか（0.5程度に調整）
3. 質問の言い回しを変えてみる

### Q9: 動作が遅いです

**A**: 以下を試してください：
1. 検索結果数を減らす（3以下）
2. データベースの件数を確認（数千件以上ある場合は遅くなる可能性）
3. PCのメモリ使用状況を確認

### Q10: エラーが出て起動しません

**A**: トラブルシューティングのセクションを参照してください。

---

## トラブルシューティング

### 起動時のエラー

#### エラー: "Python was not found"

**原因**: Pythonがインストールされていない、またはPATHが通っていない

**解決方法**:
1. Pythonを再インストール
2. インストール時に「Add Python to PATH」にチェック
3. コマンドプロンプトを再起動

#### エラー: "No module named 'streamlit'"

**原因**: パッケージがインストールされていない

**解決方法**:
```cmd
# Windowsの場合
.venv\Scripts\activate
pip install -r requirements.txt

# Mac/Linuxの場合
source .venv/bin/activate
pip install -r requirements.txt
```

#### エラー: "Address already in use"

**原因**: ポート8501が既に使用されている

**解決方法**:
別のポートで起動する
```cmd
streamlit run app.py --server.port 8502
```

### 表示の問題

#### 日本語が文字化けする（Windows）

**解決方法**:
コマンドプロンプトで以下を実行してから起動
```cmd
chcp 65001
```

または `start_app.bat` を使用（自動的に設定されます）

#### ブラウザが自動で開かない

**解決方法**:
手動でブラウザを開き、以下のURLにアクセス
```
http://localhost:8501
```

### データ処理の問題

#### ファイルをアップロードできない

**解決方法**:
1. ファイルサイズを確認（大きすぎる場合は分割）
2. ファイル形式が対応しているか確認
3. ファイルが破損していないか確認

#### Q&Aが正しく抽出されない

**解決方法**:
1. ファイル内のQ&Aフォーマットを確認
2. Excelの場合、「質問」「回答」などの列名を使用
3. テキストが読み取り可能か確認（画像化されたPDFは不可）

#### データベース構築が進まない

**解決方法**:
1. 初回起動時は埋め込みモデルのダウンロードで5-10分かかります
2. ブラウザをリロードしてみる
3. ターミナル/コマンドプロンプトにエラーが表示されていないか確認

### パフォーマンスの問題

#### 検索が遅い

**解決方法**:
1. データベースの件数を確認（数千件以上ある場合は分割を検討）
2. 検索結果数を減らす
3. PCのメモリを確認（8GB以上推奨）

#### メモリ不足エラー

**解決方法**:
1. 他のアプリケーションを終了
2. データベースを分割（カテゴリ別など）
3. より大きなメモリを持つPCを使用

### データベースのリセット

全てを初期状態に戻す場合：

**Windows**:
```cmd
rmdir /s vectordb
del data\raw\*.* （サンプル以外）
```

**Mac/Linux**:
```bash
rm -rf vectordb/
rm data/raw/* （.gitkeepは残す）
```

その後、アプリを再起動してデータを再登録してください。

---

## お問い合わせ

### サポート窓口

技術的な質問やバグ報告は、プロジェクト管理者までお問い合わせください。

### フィードバック

機能改善のご要望やご意見をお待ちしております。

### 更新情報

最新版の情報は以下を確認してください：
- README.md
- GitHubリポジトリ（該当する場合）

---

## 付録

### A. ショートカットキー

- **Ctrl + R** (Windows) / **Cmd + R** (Mac): ページをリロード
- **Ctrl + W** (Windows) / **Cmd + W** (Mac): タブを閉じる

### B. ファイル・フォルダ構成

```
security-check-ai/
├── app.py              # メインアプリケーション
├── requirements.txt    # 依存パッケージリスト
├── start_app.bat       # Windows起動スクリプト
├── start_app.sh        # Mac/Linux起動スクリプト
├── data/
│   ├── raw/           # 元データ格納フォルダ
│   └── processed/     # 処理済みデータ
├── src/               # ソースコード
└── vectordb/          # ベクトルデータベース（自動生成）
```

### C. バージョン履歴

- **v1.0** (2025年12月): 初版リリース

---

**最後に**

このツールを使って、セキュリティチェック業務の効率化を実現してください。ご不明な点がありましたら、遠慮なくお問い合わせください。

---

© 2025 Security Check AI Project
